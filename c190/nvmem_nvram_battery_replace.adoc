---
permalink: c190/nvmem-nvram-battery-replace.html 
sidebar: sidebar 
keywords: aff c190, replace nvmem battery 
summary: Para sustituir una batería de NVMEM en el sistema, debe extraer el módulo de la controladora del sistema, abrirlo, sustituir la batería y cerrar y sustituir el módulo de la controladora. 
---
= Sustituya la batería de NVMEM - AFF C190
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Para sustituir una batería de NVMEM en el sistema, debe extraer el módulo de la controladora del sistema, abrirlo, sustituir la batería y cerrar y sustituir el módulo de la controladora.

Todos los demás componentes del sistema deben funcionar correctamente; si no es así, debe ponerse en contacto con el soporte técnico.



== Paso 1: Apague el controlador dañado

Para apagar el controlador dañado, debe determinar el estado del controlador y, si es necesario, tomar el control para que el controlador sano siga sirviendo datos del almacenamiento del controlador dañado.

Si tiene un clúster con más de dos nodos, debe estar en quórum. Si el clúster no tiene quórum o si una controladora en buen estado muestra falso según su condición, debe corregir el problema antes de apagar la controladora dañada; consulte link:https://docs.netapp.com/us-en/ontap/system-admin/synchronize-node-cluster-task.html?q=Quorum["Sincronice un nodo con el clúster"^].

.Pasos
. Si AutoSupport está habilitado, elimine la creación automática de casos invocando un mensaje de AutoSupport: `system node autosupport invoke -node * -type all -message MAINT=_number_of_hours_down_h`
+
El siguiente mensaje de AutoSupport suprime la creación automática de casos durante dos horas: `cluster1:*> system node autosupport invoke -node * -type all -message MAINT=2h`

. Si la controladora dañada forma parte de un par de alta disponibilidad, deshabilite la devolución automática de la consola de la controladora en buen estado: `storage failover modify -node local -auto-giveback false`
. Lleve la controladora dañada al aviso DEL CARGADOR:
+
[cols="1,2"]
|===
| Si el controlador dañado está mostrando... | Realice lo siguiente... 


 a| 
El aviso del CARGADOR
 a| 
Vaya a Quitar módulo de controlador.



 a| 
Esperando devolución...
 a| 
Pulse Ctrl-C y, a continuación, responda `y`.



 a| 
Solicitud del sistema o solicitud de contraseña (introduzca la contraseña del sistema)
 a| 
Retome o detenga el controlador dañado del controlador en buen estado: `storage failover takeover -ofnode _impaired_node_name_`

Cuando el controlador dañado muestre esperando devolución..., pulse Ctrl-C y, a continuación, responda `y`.

|===




== Paso 2: Extraiga el módulo de controlador

Para acceder a los componentes del módulo del controlador, primero debe extraer el módulo del controlador del sistema y, a continuación, retirar la cubierta del módulo del controlador.

. Si usted no está ya conectado a tierra, correctamente tierra usted mismo.
. Afloje el gancho y la correa de bucle que sujetan los cables al dispositivo de administración de cables y, a continuación, desconecte los cables del sistema y los SFP (si fuera necesario) del módulo del controlador, manteniendo un seguimiento del lugar en el que estaban conectados los cables.
+
Deje los cables en el dispositivo de administración de cables de manera que cuando vuelva a instalar el dispositivo de administración de cables, los cables estén organizados.

. Retire y retire los dispositivos de administración de cables de los lados izquierdo y derecho del módulo del controlador.
+
image::../media/drw_25xx_cable_management_arm.png[drw 25xx cable management ARM]

. Apriete el pestillo del mango de la leva hasta que se suelte, abra el mango de la leva completamente para liberar el módulo del controlador del plano medio y, a continuación, tire con dos manos del módulo del controlador para extraerlo del chasis.
+
image::../media/drw_2240_x_opening_cam_latch.png[pestillo de leva de apertura drw 2240 x]

. Dé la vuelta al módulo del controlador y colóquelo sobre una superficie plana y estable.
. Abra la cubierta deslizando las pestañas azules para liberar la cubierta y, a continuación, gire la cubierta hacia arriba y abierta.
+
image::../media/drw_2600_opening_pcm_cover.png[drw 2600 apertura de la cubierta del pcm]





== Paso 3: Sustituya la batería de NVMEM

Para sustituir la batería de NVMEM en su sistema, debe quitar la batería de NVMEM con error del sistema y sustituirla por una nueva batería de NVMEM.

. Compruebe el LED de NVMEM:
+
** Si su sistema está en una configuración de alta disponibilidad, vaya al paso siguiente.
** Si el sistema está en una configuración independiente, apague correctamente el módulo de la controladora y, a continuación, compruebe el LED de NVRAM identificado con el icono de NV.
+
image::../media/drw_hw_nvram_icon.png[icono de drw hw nvram]

+
[NOTE]
====
El LED de NVRAM parpadea mientras se separa el contenido de la memoria flash cuando se detiene el sistema. Una vez finalizado el destete, el LED se apaga.

*** Si se pierde la alimentación sin un apagado correcto, el LED de NVMEM parpadea hasta que se completa el destino y, a continuación, se apaga el LED.
*** Si el LED está encendido y encendido, los datos no escritos se almacenan en NVMEM.
+
Esto suele ocurrir durante un apagado no controlado una vez que ONTAP se ha iniciado correctamente.



====


. Localice la batería de NVMEM en el módulo de la controladora.
+
image::../media/drw_2600_nvmem_batt_repl_animated_gif.png[gif animados drw 2600 nvmem batt repl]

. Localice el enchufe de la batería y apriete el clip en la parte frontal del enchufe de la batería para liberar el enchufe de la toma y, a continuación, desenchufe el cable de la batería de la toma.
. Extraiga la batería del módulo del controlador y déjela a un lado.
. Extraiga la batería de repuesto de su paquete.
. Enrolle el cable de la batería alrededor del canal del cable en el lateral del soporte de la batería.
. Coloque la batería alineando los resaltes de las llaves del soporte de la batería con las muescas "'V'" de la pared lateral de chapa metálica.
. Deslice la batería hacia abajo a lo largo de la pared lateral de chapa metálica hasta que las lengüetas de soporte del gancho lateral de la pared entren en las ranuras de la batería y el pestillo de la batería se acople y haga clic en la abertura de la pared lateral.
. Vuelva a enchufar el enchufe de la batería al módulo del controlador.




== Paso 4: Vuelva a instalar el módulo del controlador

Después de sustituir los componentes del módulo del controlador, debe volver a instalarlo en el chasis.

. Si aún no lo ha hecho, vuelva a colocar la cubierta del módulo del controlador.
. Alinee el extremo del módulo del controlador con la abertura del chasis y, a continuación, empuje suavemente el módulo del controlador hasta la mitad del sistema.
+

NOTE: No inserte completamente el módulo de la controladora en el chasis hasta que se le indique hacerlo.

. Recuperar el sistema, según sea necesario.
+
Si ha quitado los convertidores de medios (QSFP o SFP), recuerde volver a instalarlos si está utilizando cables de fibra óptica.

. Complete la reinstalación del módulo del controlador. El módulo de la controladora comienza a arrancar tan pronto como se asienta completamente en el chasis. Esté preparado para interrumpir el proceso de arranque.
+
.. Con la palanca de leva en la posición abierta, empuje firmemente el módulo del controlador hasta que se ajuste al plano medio y esté completamente asentado y, a continuación, cierre la palanca de leva a la posición de bloqueo.
+

NOTE: No ejerza una fuerza excesiva al deslizar el módulo del controlador hacia el chasis para evitar dañar los conectores.

+
La controladora comienza a arrancar tan pronto como se encuentra en el chasis.

.. Si aún no lo ha hecho, vuelva a instalar el dispositivo de administración de cables.
.. Conecte los cables al dispositivo de gestión de cables con la correa de gancho y lazo.
.. Cuando vea el mensaje ``Press Ctrl-C for Boot Menu``, pulse `*Ctrl-C*` para interrumpir el proceso de arranque.
+

NOTE: Si se pierde el aviso y el módulo de la controladora arranca en ONTAP, introduzca `*halt*`, Y luego en el aviso del CARGADOR entrar `*boot_ontap*`, pulse `*Ctrl-C*` Cuando se le solicite y luego arranque en modo de mantenimiento.

.. Seleccione la opción de arrancar en el modo de mantenimiento en el menú que se muestra.






== Paso 5: Ejecute un diagnóstico de nivel de sistema

Después de instalar una batería de NVMEM nueva, debería ejecutar el diagnóstico.

Su sistema debe estar en el aviso DEL CARGADOR para iniciar los diagnósticos de nivel de sistema.

Todos los comandos de los procedimientos de diagnóstico se emiten desde la controladora en la que se sustituye el componente.

. Si la controladora que se va a reparar no está en el símbolo del sistema del CARGADOR, siga estos pasos:
+
.. Seleccione la opción modo de mantenimiento en el menú que se muestra.
.. Después de que la controladora arranca en modo de mantenimiento, detenga la controladora: `halt`
+
Tras emitir el comando, debe esperar hasta que el sistema se detenga en el símbolo del sistema del CARGADOR.

+

NOTE: Durante el proceso de arranque, puede responder de forma segura `y` para solicitar:

+
*** Una advertencia de aviso que al entrar en modo de mantenimiento en una configuración de alta disponibilidad, debe asegurarse de que la controladora en buen estado permanezca inactiva.




. En el aviso DEL CARGADOR, acceda a los controladores especiales diseñados específicamente para que los diagnósticos del sistema funcionen correctamente: `boot_diags`
+
Durante el proceso de arranque, puede responder de forma segura `y` A las indicaciones hasta que aparezca el indicador del modo de mantenimiento (*>).

. Ejecute el diagnóstico de la memoria de NVMEM: `sldiag device run -dev nvmem`
. Verifique que no se haya producido ningún problema de hardware como resultado del reemplazo de la batería de NVMEM: `sldiag device status -dev nvmem -long -state failed`
+
Los diagnósticos de nivel de sistema le devuelven al prompt si no hay errores de prueba o indican el estado completo de los errores resultantes de la prueba del componente.

. Proceda según el resultado del paso anterior:
+
[cols="1,2"]
|===
| Si el diagnóstico del sistema prueba... | Realice lo siguiente... 


 a| 
Se completaron sin fallos
 a| 
.. Borre los registros de estado: `sldiag device clearstatus`
.. Compruebe que se ha borrado el registro: `sldiag device status`
+
Se muestra la siguiente respuesta predeterminada:

+
SLDIAG: No hay mensajes de registro.

.. Salir del modo de mantenimiento: `halt`
+
La controladora muestra el aviso del CARGADOR.

.. Arranque la controladora desde el símbolo del sistema del CARGADOR: `bye`
.. Devolver a la controladora a su funcionamiento normal:


|===
+
[cols="1,2"]
|===
| Si la controladora se encuentra en... | Realice lo siguiente... 


 a| 
Un par de alta disponibilidad
 a| 
Realice un aporte atrás: `storage failover giveback -ofnode _replacement_node_name_`


NOTE: Si ha deshabilitado la devolución automática, vuelva a habilitarla con el comando Storage Failover modify.



 a| 
Una configuración independiente
 a| 
Continúe con el próximo paso.

No se requiere ninguna acción.

Ha completado el diagnóstico de nivel del sistema.



 a| 
Se produjeron algunos fallos en las pruebas
 a| 
Determine la causa del problema:

.. Salir del modo de mantenimiento: `halt`
+
Después de emitir el comando, espere hasta que el sistema se detenga en el símbolo del sistema del CARGADOR.

.. Apague o deje las fuentes de alimentación en función del número de módulos de controladora que haya en el chasis:
+
*** Si tiene dos módulos de controladora en el chasis, deje las fuentes de alimentación encendidas para proporcionar alimentación al otro módulo de controladora.
*** Si tiene un módulo de controlador en el chasis, apague las fuentes de alimentación y desenchúfelas de las fuentes de alimentación.


.. Compruebe que ha observado todos los aspectos identificados a la hora de ejecutar diagnósticos de nivel de sistema, que los cables estén conectados de forma segura y que los componentes de hardware estén instalados correctamente en el sistema de almacenamiento.
.. Inicie el módulo del controlador que está realizando el mantenimiento, interrumpiendo el arranque pulsando `Ctrl-C` Cuando se le solicite acceder al menú Inicio:
+
*** Si tiene dos módulos de controladora en el chasis, coloque a fondo el módulo de controladora que va a mantener en el chasis.
+
El módulo del controlador se arranca cuando está completamente asentado.

*** Si tiene un módulo de controladora en el chasis, conecte las fuentes de alimentación y, a continuación, enciéndalas.


.. Seleccione Boot to maintenance mode (Inicio al modo de mantenimiento) en el menú.
.. Para salir del modo de mantenimiento, introduzca el siguiente comando: `halt`
+
Después de emitir el comando, espere hasta que el sistema se detenga en el símbolo del sistema del CARGADOR.

.. Vuelva a ejecutar la prueba de diagnóstico de nivel del sistema.


|===




== Paso 6: Devuelva la pieza que falló a NetApp

Devuelva la pieza que ha fallado a NetApp, como se describe en las instrucciones de RMA que se suministran con el kit. Consulte https://["Retorno de artículo  sustituciones"] para obtener más información.
