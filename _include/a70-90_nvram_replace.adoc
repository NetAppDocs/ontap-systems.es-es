= Paso 3: Reasignar discos
:allow-uri-read: 


Sustituya el módulo NVRAM o los DIMM de NVRAM con la siguiente opción adecuada.

[role="tabbed-block"]
====
.Opción 1: Sustituya el módulo NVRAM
--
Para sustituir el módulo NVRAM, búsquelo en la ranura 4/5 del chasis y siga la secuencia específica de pasos.

. Asegúrese de que todas las unidades del chasis estén firmemente asentadas contra el plano medio con los pulgares para empujar cada unidad hasta que sienta una parada positiva.
+
image::../media/drw_a800_drive_seated_IEOPS-960.svg[Unidades de disco de asiento]

. Vaya a la parte posterior del chasis. Si usted no está ya conectado a tierra, correctamente tierra usted mismo.
. Si usted no está ya conectado a tierra, correctamente tierra usted mismo.
. Desconecte las fuentes de alimentación del controlador.
+

NOTE: Si el sistema tiene alimentación de CC, desconecte el bloque de alimentación de las PSU.

. Gire hacia abajo la bandeja de gestión de cables tirando de los botones del interior de la bandeja de gestión de cables y girándola hacia abajo.
. Quite el módulo NVRAM de destino del chasis:
+
.. Pulse el botón de bloqueo de leva.
+
El botón de leva se aleja del chasis.

.. Gire el pestillo de leva hasta el tope.
.. Retire el módulo NVRAM defectuoso del chasis enganchando el dedo en la abertura de la palanca de leva y tirando del módulo para sacarlo del chasis.
+
image::../media/drw_a70-90_nvram12_remove_replace_ieops-1370.svg[Retire el módulo NVRAM12 y los DIMM]

+
[cols="1,4"]
|===


 a| 
image:../media/icon_round_1.png["Número de llamada 1"]
 a| 
Botón de bloqueo de leva



 a| 
image:../media/icon_round_2.png["Número de llamada 2"]
 a| 
Lengüetas de bloqueo DIMM

|===


. Ajuste el módulo NVRAM en una superficie estable.
. Retire los DIMM, uno por uno, del módulo NVRAM dañado e instálelos en el módulo NVRAM de reemplazo.
. Instale el módulo NVRAM de repuesto en el chasis:
+
.. Alinee el módulo con los bordes de la abertura del chasis en la ranura 4/5.
.. Deslice suavemente el módulo en la ranura hasta el fondo y, a continuación, empuje el pestillo de leva completamente hacia arriba para bloquear el módulo en su sitio.


. Conecte los cables de alimentación en las fuentes de alimentación. El controlador se reinicia tan pronto como se restablece la energía.
+

NOTE: Si tiene fuentes de alimentación de CC, vuelva a conectar el bloque de alimentación a las fuentes de alimentación.

. Gire la bandeja de gestión de cables hasta la posición cerrada.
. Devuelva el controlador deteriorado al funcionamiento normal devolviendo su almacenamiento: `storage failover giveback -ofnode _impaired_node_name_`.
. Si se ha desactivado la devolución automática, vuelva a activarla `storage failover modify -node local -auto-giveback true`: .
. Si AutoSupport está activado, restaurar/desactivar la supresión de la creación automática de casos `system node autosupport invoke -node * -type all -message MAINT=END`: .


--
.Opción 2: Sustituya el módulo DIMM de NVRAM
--
Para sustituir los módulos DIMM NVRAM en el módulo NVRAM, primero debe extraer el módulo NVRAM y, a continuación, sustituir el módulo DIMM de destino.

. Asegúrese de que todas las unidades del chasis estén firmemente asentadas contra el plano medio con los pulgares para empujar cada unidad hasta que sienta una parada positiva.
+
image::../media/drw_a800_drive_seated_IEOPS-960.svg[Unidades de disco de asiento]

. Vaya a la parte posterior del chasis. Si usted no está ya conectado a tierra, correctamente tierra usted mismo.
. Desconecte las fuentes de alimentación del controlador.
+

NOTE: Si el sistema tiene alimentación de CC, desconecte el bloque de alimentación de las PSU.

. Gire la bandeja de gestión de cables hacia abajo tirando suavemente de las clavijas de los extremos de la bandeja y girando la bandeja hacia abajo.
. Quite el módulo NVRAM de destino del chasis:
+
.. Pulse el botón de leva.
+
El botón de leva se aleja del chasis.

.. Gire el pestillo de leva hasta el tope.
.. Retire el módulo NVRAM del chasis enganchando el dedo en la abertura de la palanca de leva y sacando el módulo del chasis.
+
image::../media/drw_a70-90_nvram12_remove_replace_ieops-1370.svg[Retire el módulo NVRAM12 y los DIMM]

+
[cols="1,4"]
|===


 a| 
image:../media/icon_round_1.png["Número de llamada 1"]
| Botón de bloqueo de leva 


 a| 
image:../media/icon_round_2.png["Número de llamada 2"]
 a| 
Lengüetas de bloqueo DIMM

|===


. Ajuste el módulo NVRAM en una superficie estable.
. Localice el DIMM que se va a sustituir dentro del módulo NVRAM.
+

NOTE: Consulte la etiqueta de asignación de FRU en el lateral del módulo NVRAM para determinar la ubicación de las ranuras DIMM 1 y 2.

. Retire el módulo DIMM presionando hacia abajo las lengüetas de bloqueo del módulo DIMM y levantando el módulo DIMM para extraerlo del conector.
. Instale el módulo DIMM de repuesto alineando el módulo DIMM con el zócalo e empuje suavemente el módulo DIMM hacia el zócalo hasta que las lengüetas de bloqueo queden trabadas en su lugar.
. Instale el módulo NVRAM en el chasis:
+
.. Deslice suavemente el módulo en la ranura hasta que el pestillo de leva comience a acoplarse con el pasador de leva de E/S y, a continuación, gire el pestillo de leva completamente hacia arriba para bloquear el módulo en su sitio.


. Conecte los cables de alimentación en las fuentes de alimentación. El controlador se reinicia tan pronto como se restablece la energía.
+

NOTE: Si tiene fuentes de alimentación de CC, vuelva a conectar el bloque de alimentación a las fuentes de alimentación.

. Gire la bandeja de gestión de cables hasta la posición cerrada.
. Devuelva el controlador deteriorado al funcionamiento normal devolviendo su almacenamiento: `storage failover giveback -ofnode _impaired_node_name_`.
. Si se ha desactivado la devolución automática, vuelva a activarla `storage failover modify -node local -auto-giveback true`: .
. Si AutoSupport está activado, restaurar/desactivar la supresión de la creación automática de casos `system node autosupport invoke -node * -type all -message MAINT=END`: .


--
====


== Paso 3: Reasignar discos

Debe confirmar el cambio de ID del sistema al arrancar la controladora y luego verificar que se haya implementado el cambio.


CAUTION: La reasignación de discos solo se necesita al sustituir el módulo NVRAM y no se aplica al reemplazo de DIMM de NVRAM.

.Pasos
. Si el controlador está en modo de mantenimiento (mostrando el `*>` indicador), salga del modo Mantenimiento y vaya al indicador LOADER:
+
`halt`

. En el aviso del CARGADOR en la controladora, arranque la controladora e introduzca _y_ cuando se le solicite anular el ID del sistema debido a una discrepancia del ID del sistema.
. Espere hasta que aparezca el mensaje Esperando devolución en la consola del controlador con el módulo de reemplazo y luego, desde el controlador en buen estado, verifique que se haya asignado automáticamente el nuevo ID del sistema asociado:
+
`storage failover show`

+
En la salida del comando, debería ver un mensaje que indique que la ID del sistema ha cambiado en el controlador dañado, mostrando las ID antiguas y nuevas correctas.  En el siguiente ejemplo, el nodo 2 ha sido reemplazado y tiene un nuevo ID de sistema de 151759706.

+
[listing]
----
node1:> storage failover show
                                    Takeover
Node              Partner           Possible     State Description
------------      ------------      --------     -------------------------------------
node1             node2             false        System ID changed on partner (Old:
                                                  151759755, New: 151759706), In takeover
node2             node1             -            Waiting for giveback (HA mailboxes)
----
. Devolver la controladora:
+
.. Desde el controlador en buen estado, devuelva el almacenamiento del controlador reemplazado: +
`storage failover giveback -ofnode replacement_node_name`
+
La controladora recupera su almacenamiento y completa el arranque.

+
Si se le solicita que sustituya el ID del sistema debido a una discrepancia de ID del sistema, debe introducir _y_.

+
Si el retorno se vetó, puede considerar la sustitución de los vetos.

+
Para obtener más información, consulte https://docs.netapp.com/us-en/ontap/high-availability/ha_manual_giveback.html#if-giveback-is-interrupted["comandos de devolución manual"^] para anular el veto.

.. Una vez completada la devolución, confirme que la pareja de alta disponibilidad esté en buen estado y que la toma de control sea posible: _Storage failover show_
+
La salida de `storage failover show` El comando no debe incluir el ID del sistema cambiado en el mensaje del partner.



. Verifique que los discos se hayan asignado correctamente:
+
`storage disk show -ownership`

+
Los discos que pertenecen a la controladora deben mostrar el nuevo ID del sistema. En el ejemplo siguiente, los discos propiedad del nodo 1 ahora muestran el nuevo ID del sistema, 151759706:

+
[listing]
----
node1:> storage disk show -ownership

Disk  Aggregate Home  Owner  DR Home  Home ID    Owner ID  DR Home ID Reserver  Pool
----- ------    ----- ------ -------- -------    -------    -------  ---------  ---
1.0.0  aggr0_1  node1 node1  -        151759706  151759706  -       151759706 Pool0
1.0.1  aggr0_1  node1 node1           151759706  151759706  -       151759706 Pool0
.
.
.
----
. Si el sistema tiene una configuración MetroCluster, supervise el estado de la controladora: _MetroCluster node show_
+
La configuración de MetroCluster tarda unos minutos después del reemplazo y vuelve a su estado normal, momento en el que cada controladora mostrará un estado configurado, con mirroring de DR habilitado y un modo normal. La `metrocluster node show -fields node-systemid` El resultado del comando muestra el ID del sistema antiguo hasta que la configuración de MetroCluster vuelve a ser un estado normal.

. Si la controladora está en una configuración MetroCluster, según el estado del MetroCluster, compruebe que el campo ID de inicio de recuperación ante desastres muestra el propietario original del disco si el propietario original es una controladora del sitio de recuperación ante desastres.
+
Esto es necesario si se cumplen las dos opciones siguientes:

+
** La configuración de MetroCluster está en estado de conmutación.
** El controlador es el propietario actual de los discos en el sitio de recuperación ante desastres.
+
Consulte https://docs.netapp.com/us-en/ontap-metrocluster/manage/concept_understanding_mcc_data_protection_and_disaster_recovery.html#disk-ownership-changes-during-ha-takeover-and-metrocluster-switchover-in-a-four-node-metrocluster-configuration["Cambios en la propiedad de disco durante la toma de control de alta disponibilidad y el cambio de MetroCluster en una configuración MetroCluster de cuatro nodos"] si quiere más información.



. Si su sistema tiene una configuración de MetroCluster, verifique que cada controladora esté configurada: _MetroCluster node show - fields configuration-state_
+
[listing]
----
node1_siteA::> metrocluster node show -fields configuration-state

dr-group-id            cluster node           configuration-state
-----------            ---------------------- -------------- -------------------
1 node1_siteA          node1mcc-001           configured
1 node1_siteA          node1mcc-002           configured
1 node1_siteB          node1mcc-003           configured
1 node1_siteB          node1mcc-004           configured

4 entries were displayed.
----
. Verifique que los volúmenes esperados estén presentes para cada controlador:
+
`vol show -node node-name`

. Si el cifrado del almacenamiento está habilitado, debe restaurar la funcionalidad.
. Devuelva la controladora afectada a su funcionamiento normal devolviendo su almacenamiento:
+
`storage failover giveback -ofnode _impaired_node_name_`.

. Si la devolución automática está desactivada, vuelva a habilitarla:
+
`storage failover modify -node local -auto-giveback true`.

. Si AutoSupport está habilitado, restaure o desactive la creación automática de casos:
+
`system node autosupport invoke -node * -type all -message MAINT=END`.


